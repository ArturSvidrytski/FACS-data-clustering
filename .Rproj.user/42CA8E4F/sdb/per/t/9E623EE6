{
    "collab_server" : "",
    "contents" : "save.figure <- function(data, labels, figname, file, wdth = 2048, hght = 1024  ){\n  png(filename = file, width = wdth, height = hght  )\n  plot( data\n  , pch = 20\n  , col = labels\n  , main = figname )\ndev.off()\n}\n\nretrieve.cl.info <- function( data, labels ){\n  \n  library(tibble)\n  \n  cl.lbls <- unique(labels)\n  cl.amount <- length(cl.lbls)\n  \n  tib.cur.cl.inf <- tibble(\n      cl_cell_amount = integer(cl.amount)\n    , quality_Q1_mean = numeric(cl.amount)\n    , quality_Q2_mean = numeric(cl.amount)\n    , quality_Q3 = numeric(cl.amount)\n    , quality_Q1_med = numeric(cl.amount)\n    , quality_Q2_med = numeric(cl.amount)\n    , cl_radius_mean = numeric(cl.amount)\n    , cl_radius_med = numeric(cl.amount)\n    , cl_variance_mean = numeric(cl.amount)\n    , cl_variance_med = numeric(cl.amount)\n    , cent_GRN_mean = numeric(cl.amount)\n    , cent_RED_mean = numeric(cl.amount)\n    , cent_YEL_mean = numeric(cl.amount)\n    , var_GRN_mean = numeric(cl.amount)\n    , var_RED_mean = numeric(cl.amount)\n    , var_YEL_mean = numeric(cl.amount)\n    , cent_GRN_med = numeric(cl.amount)\n    , cent_RED_med = numeric(cl.amount)\n    , cent_YEL_med = numeric(cl.amount)\n    , var_GRN_med = numeric(cl.amount)\n    , var_RED_med = numeric(cl.amount)\n    , var_YEL_med = numeric(cl.amount)\n  )\n\n  quality_Q1_mean <- 0\n  quality_Q2_mean <- 0\n  quality_Q3 <- 0\n  quality_Q1_med <- 0\n  quality_Q2_med <- 0\n  \n  for( cl.idx in 1:cl.amount ){\n    is.lbl <- labels == cl.lbls[cl.idx]\n    cur.data <- data[is.lbl, ]\n    \n    cl_cell_amount <- sum( is.lbl )\n    \n    cent_mean <- colMeans( cur.data )\n    cent_med <- apply( cur.data, MARGIN = 2, FUN = median )\n    var_mean <- apply( cur.data, MARGIN = 2, FUN = var )\n    var_med <-  \n      apply( cur.data - cent_med, MARGIN = 2, FUN = function(x){\n        sum( x^2 )/length(x)\n      })\n\n    cmean.dist <- dist( rbind( cent_mean, cur.data ) )\n    cl_radius_mean <- max( cmean.dist[1:nrow(cur.data)] )\n    cl_variance_mean <- mean( cmean.dist[1:nrow(cur.data)]^2 )\n    quality_Q1_mean <- quality_Q1_mean + sum( cmean.dist[1:nrow(cur.data)] )\n    quality_Q2_mean <- quality_Q2_mean + sum( cmean.dist[1:nrow(cur.data)]^2 )\n    \n    cmed.dist <- dist( rbind( cent_med, cur.data ) )\n    cl_radius_med <- max( cmed.dist[1:nrow(cur.data)] )\n    cl_variance_med <- mean( cmed.dist[1:nrow(cur.data)]^2 )\n    quality_Q1_med <- quality_Q1_med + sum( cmed.dist[1:nrow(cur.data)] )\n    quality_Q2_med <- quality_Q2_med + sum( cmed.dist[1:nrow(cur.data)]^2 )\n    \n    quality_Q3 <- quality_Q3 + sum(dist(cur.data))\n    \n    \n    tib.cur.cl.inf[ cl.idx , c(  'cl_cell_amount'\n                               , 'cl_radius_mean'\n                               , 'cl_radius_med'\n                               , 'cl_variance_mean'\n                               , 'cl_variance_med' \n                               , 'cent_GRN_mean'\n                               , 'cent_RED_mean'\n                               , 'cent_YEL_mean' \n                               , 'var_GRN_mean'\n                               , 'var_RED_mean'\n                               , 'var_YEL_mean'\n                               , 'cent_GRN_med'\n                               , 'cent_RED_med'\n                               , 'cent_YEL_med'\n                               , 'var_GRN_med'\n                               , 'var_RED_med'\n                               , 'var_YEL_med') ] <- \n      c(   cl_cell_amount\n         , cl_radius_mean\n         , cl_radius_med\n         , cl_variance_mean\n         , cl_variance_med\n         , cent_mean[1:3]\n         , var_mean[1:3]\n         , cent_med[1:3]\n         , var_med[1:3]\n         )\n  }\n  \n  quality_Q1_mean <- quality_Q1_mean / nrow( data )\n  quality_Q2_mean <- quality_Q2_mean / nrow( data )\n  quality_Q3 <- quality_Q3 / nrow( data )\n  quality_Q1_med <- quality_Q1_med / nrow( data )\n  quality_Q2_med <- quality_Q2_med / nrow( data )\n  \n  tib.cur.cl.inf$quality_Q1_mean  <- quality_Q1_mean\n  tib.cur.cl.inf$quality_Q2_mean <- quality_Q2_mean\n  tib.cur.cl.inf$quality_Q3 <- quality_Q3\n  tib.cur.cl.inf$quality_Q1_med <- quality_Q1_med \n  tib.cur.cl.inf$quality_Q2_med <- quality_Q2_med \n  \n  return( tib.cur.cl.inf )\n}\n\n\n",
    "created" : 1534705314398.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4134365908",
    "id" : "9E623EE6",
    "lastKnownWriteTime" : 1537982154,
    "last_content_update" : 1537982154677,
    "path" : "D:/1_Work/PROJECTS/Side_projects/RPr_Cell_Survival_Analysis/additional_functions.R",
    "project_path" : "additional_functions.R",
    "properties" : {
        "docOutlineVisible" : "0",
        "tempName" : "Untitled4"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}